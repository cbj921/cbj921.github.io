window.__require=function t(e,i,n){function c(a,o){if(!i[a]){if(!e[a]){var r=a.split("/");if(r=r[r.length-1],!e[r]){var h="function"==typeof __require&&__require;if(!o&&h)return h(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+a+"'")}}var l=i[a]={exports:{}};e[a][0].call(l.exports,function(t){return c(e[a][1][t]||t)},l,l.exports,t,e,i,n)}return i[a].exports}for(var s="function"==typeof __require&&__require,a=0;a<n.length;a++)c(n[a]);return c}({cameraMove:[function(t,e,i){"use strict";cc._RF.push(e,"2dba4GnP/JH2YfCDeavFkED","cameraMove"),cc.Class({extends:cc.Component,properties:{limitPos:[cc.Vec2],moveToPos:[cc.Vec2],_limitIndex:0,_movePosIndex:0},onLoad:function(){this._limitIndex=0,this._movePosIndex=0,this.player=cc.find("player")},update:function(t){this.updateCameraPos()},updateCameraPos:function(){var t=this.player.x;this._limitIndex<this.limitPos.length&&t>=this.limitPos[this._limitIndex].x&&(this.node.position=this.moveToPos[this._movePosIndex+1],this._limitIndex++,this._movePosIndex++),this._limitIndex>0&&t<=this.limitPos[this._limitIndex-1].x&&(this.node.position=this.moveToPos[this._movePosIndex-1],this._limitIndex--,this._movePosIndex--)}}),cc._RF.pop()},{}],chooseBtn:[function(t,e,i){"use strict";cc._RF.push(e,"fa9ffSxmmZPo5Snk0Jatn1n","chooseBtn"),cc.Class({extends:cc.Component,properties:{_optionData:null,labelText:cc.Label},btnInit:function(t,e,i,n){var c=this;this.talkSys=t,this.btn=this.node.getComponent(cc.Button),this.labelText.string=e,cc.director.on("btnPress",function(){c.btn.interactable=!1},this),this._optionData={target:i,option:n}},btnPress:function(){cc.director.emit("btnPress"),this.talkSys.emit("finishSelect",this._optionData)}}),cc._RF.pop()},{}],endScript:[function(t,e,i){"use strict";cc._RF.push(e,"bd48esScbBB3Kqq+FAX3DDE","endScript"),cc.Class({extends:cc.Component,properties:{endText:cc.JsonAsset,textLabel:cc.Label,endTextIndex:0,restartBtn:cc.Node},onLoad:function(){var t=this;this.textLabel.node.opacity=0,this.restartBtn.active=!1,this.text=this.endText.json,this.textLabel.string=this.text[this.endTextIndex].text;var e=cc.fadeIn(5),i=cc.callFunc(function(){t.restartBtn.active=!0}),n=cc.sequence(e,i);this.textLabel.node.runAction(n)},restartGame:function(){var t=this;this.canvas=cc.find("Canvas"),this.talkSys=cc.find("talkSys"),this.player=cc.find("player");var e=cc.fadeOut(3),i=cc.callFunc(function(){cc.director.loadScene("startScene",function(){t.player.destroy(),t.talkSys.destroy()})}),n=cc.sequence(e,i);cc.director.preloadScene("startScene",function(){console.log("preload completed!")}),this.canvas.runAction(n)}}),cc._RF.pop()},{}],firstSceneInit:[function(t,e,i){"use strict";cc._RF.push(e,"d5450TJATxMjauBd7YpeMia","firstSceneInit"),cc.Class({extends:cc.Component,properties:{player:cc.Node,playerStartPos:cc.Vec2},onLoad:function(){cc.director.getCollisionManager().enabled=!0,this.initPeoplePos()},initPeoplePos:function(){this.player.position=this.playerStartPos}}),cc._RF.pop()},{}],globalPlayer:[function(t,e,i){"use strict";cc._RF.push(e,"fd1954jWSVLWKn6rDBnN2qQ","globalPlayer"),cc.Class({extends:cc.Component,properties:{_armatureDisPlay:null,_armature:null},onLoad:function(){cc.game.addPersistRootNode(this.node),this.addListenMoveEvent(),this._armatureDisPlay=this.getComponent(dragonBones.ArmatureDisplay),this._armature=this._armatureDisPlay.armature(),this._armatureDisPlay.timeScale=.1,this._armatureDisPlay.playAnimation("stand",0),cc.director.on("lockMove",this.stopWalk,this)},stopWalk:function(){this._armatureDisPlay.timeScale=.1,this._armatureDisPlay.playAnimation("stand",0)},addListenMoveEvent:function(){cc.director.on("action",this.playMoveAnim,this)},playMoveAnim:function(t){"right"==t?(this.node.scaleX=1,this._armatureDisPlay.timeScale=1,this._armatureDisPlay.playAnimation("walk",0)):"left"==t?(this.node.scaleX=-1,this._armatureDisPlay.timeScale=1,this._armatureDisPlay.playAnimation("walk",0)):"up"==t&&cc.log("up"),"stop"==t&&(this._armatureDisPlay.timeScale=.1,this._armatureDisPlay.playAnimation("stand",0))}}),cc._RF.pop()},{}],labelFadeout:[function(t,e,i){"use strict";cc._RF.push(e,"d0cc3uW0cJCIqkW7b8dTFf5","labelFadeout"),cc.Class({extends:cc.Component,properties:{fadeInTime:2,fadeOutTime:2,delayTime:5},onLoad:function(){this.node.on("playAttention",this.playAnim,this),this.node.opacity=0},playAnim:function(){var t=cc.fadeIn(this.fadeInTime),e=cc.fadeOut(this.fadeOutTime),i=cc.delayTime(this.delayTime),n=cc.sequence(t,i,e);this.node.runAction(n)}}),cc._RF.pop()},{}],listScrollView:[function(t,e,i){"use strict";cc._RF.push(e,"a8343f3o/dN+5JkI+cRPIFE","listScrollView"),cc.Class({extends:cc.Component,properties:{scrollView:{default:null,type:cc.ScrollView},stateMentPrefab:cc.Prefab,spacing:0,stateMentX:0,_stateMentCount:0},onLoad:function(){this.content=this.scrollView.content,this.content.height=0},makeStateMentPrefab:function(){this._stateMentCount++;var t=cc.instantiate(this.stateMentPrefab);this.content.addChild(t);var e=this._stateMentCount*(this.spacing+t.height),i=cc.v2(this.stateMentX,-this._stateMentCount*(this.spacing+.5*t.height));return this.content.height=e,t.position=i,this.scrollView.scrollToOffset(cc.v2(0,-(t.y+this.spacing+100)),.5),t},initStateMent:function(t,e,i){var n=t.getComponent("stateMent");n.changeHeadSprite(e),n.playTextLabel(i)}}),cc._RF.pop()},{}],moveCtl:[function(t,e,i){"use strict";cc._RF.push(e,"cb5a6rbg8dJMZloBHEw7Se6","moveCtl"),cc.Class({extends:cc.Component,properties:{maxMoveSpeed:0,accel:0,_xSpeed:0,_accLeft:!1,_accRight:!1,_accUp:!1,_lastEventFlag:!1,_nowEventFlag:!1},onLoad:function(){this.initVar(),this.addKeyEventListen(),this.listenStopOrRestartEvent()},update:function(t){this.playerMove(t)},addKeyEventListen:function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},removeKeyEventListen:function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),this.initVar()},initVar:function(){this._xSpeed=0,this._accLeft=!1,this._accRight=!1,this._jumpFlag=!1,this._nowEventFlag=!1,this._lastEventFlag=!1,this._jumpAction=void 0},onKeyDown:function(t){switch(t.keyCode){case cc.macro.KEY.a:this._accLeft=!0,this._nowEventFlag=!0,this.sendKeyEvent("action","left");break;case cc.macro.KEY.d:this._accRight=!0,this._nowEventFlag=!0,this.sendKeyEvent("action","right");break;case cc.macro.KEY.w:this._accUp=!0,this._nowEventFlag=!0,this.sendKeyEvent("action","up")}},onKeyUp:function(t){switch(t.keyCode){case cc.macro.KEY.a:case cc.macro.KEY.d:this._accLeft=!1,this._accRight=!1,this._nowEventFlag=!1,this._lastEventFlag=!1,this._xSpeed=0,this.sendKeyEvent("action","stop");break;case cc.macro.KEY.w:this._accUp=!1,this._nowEventFlag=!1,this._lastEventFlag=!1}},sendKeyEvent:function(t,e){"stop"==e&&cc.director.emit(t,e),!this._lastEventFlag&&this._nowEventFlag&&(cc.director.emit(t,e),this._lastEventFlag=!0)},playerMove:function(t){this._accLeft?this._xSpeed-=this.accel*t:this._accRight&&(this._xSpeed+=this.accel*t),Math.abs(this._xSpeed)>this.maxMoveSpeed&&(this._xSpeed=this.maxMoveSpeed*this._xSpeed/Math.abs(this._xSpeed)),this.node.x+=this._xSpeed*t},listenStopOrRestartEvent:function(){cc.director.on("lockMove",this.removeKeyEventListen,this),cc.director.on("restartMove",this.addKeyEventListen,this)}}),cc._RF.pop()},{}],startBtn:[function(t,e,i){"use strict";cc._RF.push(e,"9deccK2mM9NkrISEsUhEGG7","startBtn"),cc.Class({extends:cc.Component,properties:{button:cc.Node,player:cc.Node,title:cc.Node,attentionLabel:cc.Node,disapperDuration:2,_sendEventCount:0},onLoad:function(){this.button.on("touchstart",this.startGame,this),this._sendEventCount=0},startGame:function(){this.disappearAction(this.button),this.disappearAction(this.title)},disappearAction:function(t){var e=this,i=cc.callFunc(function(){e._sendEventCount<1&&(e.player.emit("startGame"),e.attentionLabel.emit("playAttention"),e._sendEventCount++),e.node.destroy()}),n=cc.fadeOut(this.disapperDuration),c=cc.sequence(n,i);t.runAction(c)}}),cc._RF.pop()},{}],startPlayerAnim:[function(t,e,i){"use strict";cc._RF.push(e,"3354dTyRU1OfZJYn+YY4ZX0","startPlayerAnim"),cc.Class({extends:cc.Component,properties:{startPos:cc.Vec2,endPos:cc.Vec2,backGround:cc.Node,moveDuration:5,bgFadeOutTime:3},onLoad:function(){this.node.on("startGame",this.playAnim,this),this.node.position=this.startPos},playAnim:function(){var t=this,e=cc.moveTo(this.moveDuration,this.endPos),i=cc.callFunc(function(){var e=cc.fadeOut(t.bgFadeOutTime),i=cc.callFunc(function(){cc.director.loadScene("firstScene")}),n=cc.sequence(e,i);t.backGround.runAction(n)}),n=cc.sequence(e,i);cc.director.preloadScene("firstScene",function(){console.log("preload completed!")}),this.node.runAction(n)}}),cc._RF.pop()},{}],stateMent:[function(t,e,i){"use strict";cc._RF.push(e,"2fd323icUNKx4OV8Ob58NUC","stateMent"),cc.Class({extends:cc.Component,properties:{headSprite:cc.Sprite,textLabel:cc.Label,headTextures:[cc.SpriteFrame]},onLoad:function(){this.playTextLabel("\u4f60\u597d")},changeHeadSprite:function(t){var e=null;switch(t){case"player":e=this.headTextures[0];break;case"cactus":e=this.headTextures[1];break;case"queen":e=this.headTextures[2];break;case"cat":e=this.headTextures[3];break;case"guide1":case"guide2":e=this.headTextures[4];break;case"secretMan1":case"secretMan2":e=this.headTextures[5];break;case"solider1":case"solider2":case"solider3":e=this.headTextures[6];break;case"maid1":case"maid2":e=this.headTextures[7];break;case"wuzetian":e=this.headTextures[8];break;case"guard1":case"guard2":case"guard3":e=this.headTextures[9];break;case"trump":e=this.headTextures[10];break;case"starfish":e=this.headTextures[11];break;case"crab":e=this.headTextures[12];break;case"kaisa":e=this.headTextures[13]}this.headSprite.spriteFrame=e},playTextLabel:function(t){this.textLabel.string=t}}),cc._RF.pop()},{}],talkSys:[function(t,e,i){"use strict";cc._RF.push(e,"6d672F7679B2JPDrM3pk3MC","talkSys"),cc.Class({extends:cc.Component,properties:{_talkingFlag:!1,_chooseFlag:!1,_textIndex:0,_talkTarget:cc.String,_optionData:null,_optionSaveArray:[],textJson:cc.JsonAsset,stateMentPrefab:cc.Prefab,optionPrefab:cc.Prefab,gameOverPrefab:cc.Prefab,player:cc.Node,scrollView:{default:null,type:cc.ScrollView},spacing:0,stateMentX:0,_stateMentCount:0},onLoad:function(){cc.game.addPersistRootNode(this.node),cc.director.on("talkStart",this.playTalk,this),cc.director.on("textBoxHide",this.hideTextBox,this),this.node.on("touchstart",this.nextTalk,this),this.node.on("finishSelect",this.saveOptionData,this),this._textJson=this.textJson.json,this._attentionLabel=this.node.getChildByName("attention").getComponent(cc.Label),this._attentionLabel.string="\u70b9\u51fb\u8be5\u533a\u57df\u8fdb\u884c\u4e0b\u4e00\u53e5\u5bf9\u8bdd",this.node.position=cc.v2(250,2500),this.content=this.scrollView.content,this.content.height=0,this.canvas=cc.find("Canvas")},playTalk:function(t){var e=this;if(!this._talkingFlag){this._talkingFlag=!0,this._talkTarget=t,this.roleText=this._textJson[t].content;var i=this._textJson[t].length;cc.director.emit("lockMove"),this._textIndex<1&&(this._attentionLabel.string="\u70b9\u51fb\u8be5\u533a\u57df\u8fdb\u884c\u4e0b\u4e00\u53e5\u5bf9\u8bdd"),this.node.x=this.player.x+200,this.player.x>1200&&this.player.x<1920&&(this.node.x=this.player.x-200),this.node.y=746;var n=this.makeStateMentPrefab(this.stateMentPrefab);if(this._textIndex<i){if("other"==this.roleText[this._textIndex].role?this.initStateMent(n,t,this.roleText[this._textIndex].text):this.initStateMent(n,"player",this.roleText[this._textIndex].text),void 0!=this.roleText[this._textIndex].choose){for(var c in this._chooseFlag=!1,this.roleText[this._textIndex].choose)if(void 0!=c){var s=this.makeStateMentPrefab(this.optionPrefab);this.initOptionBtn(s,this.roleText[this._textIndex].choose[c].text,t,c)}return this.node.off("touchstart",this.nextTalk,this),void this.node.on("finishSelect",function(t){e._chooseFlag||(void 0!=e.roleText[e._textIndex].choose&&(e._textIndex=Number(e.roleText[e._textIndex].choose[t.option].link)),e._chooseFlag=!0,e.node.on("touchstart",e.nextTalk,e),e._talkingFlag=!1,e.nextTalk())},this)}if(void 0!=this.roleText[this._textIndex].nextScene&&(this.loadSceneAnim(this.roleText[this._textIndex].nextScene),cc.log(this.roleText[this._textIndex].nextScene)),void 0!=this.roleText[this._textIndex].gameOver)return this.gameOver(),void cc.log("gameOver");1!=this.roleText[this._textIndex].end?this._textIndex++:(this._textIndex=0,this._talkTarget=null,cc.director.emit("restartMove"),this._attentionLabel.string="\u5bf9\u8bdd\u7ed3\u675f"),this._talkingFlag=!1}}},nextTalk:function(){null!=this._talkTarget&&this.playTalk(this._talkTarget)},hideTextBox:function(){this.node.position=cc.v2(250,2500)},saveOptionData:function(t){this._optionSaveArray.push(t)},loadSceneAnim:function(t){var e=this;this.canvas=cc.find("Canvas");var i=cc.moveTo(2,cc.v2(3960,208));if("endScene"!=t){var n=cc.callFunc(function(){var i=cc.fadeOut(4),n=cc.callFunc(function(){cc.director.loadScene(t,function(){e.player.position=cc.v2(146,208),cc.director.emit("action","stop")})}),c=cc.sequence(i,n);e.canvas.runAction(c)}),c=cc.sequence(i,n);cc.director.preloadScene(t,function(){console.log("preload completed!")}),this.player.runAction(c),cc.director.emit("action","right")}else if("endScene"==t){var s=Math.floor(10*Math.random());cc.log(s),t=s<4?"endScene1":s>4&&s<7?"endScene2":"endScene3";var a=cc.fadeOut(4),o=cc.callFunc(function(){cc.director.loadScene(t,function(){e.player.position=cc.v2(146,208),cc.director.emit("action","stop")})}),r=cc.sequence(a,o);this.canvas.runAction(r)}},gameOver:function(){var t=this;this.canvas=cc.find("Canvas"),this._attentionLabel.node.color=cc.color(255,0,0),this._attentionLabel.string="\u6e38\u620f\u7ed3\u675f\uff01";var e=cc.fadeOut(3),i=cc.callFunc(function(){cc.director.loadScene("startScene",function(){t.player.destroy(),t.node.destroy()})}),n=cc.sequence(e,i);cc.director.preloadScene("startScene",function(){console.log("preload completed!")}),this.canvas.runAction(n)},makeStateMentPrefab:function(t){this._stateMentCount++;var e=cc.instantiate(t);this.content.addChild(e);var i=this._stateMentCount*(e.height+this.spacing)+this.spacing,n=cc.v2(this.stateMentX,-this._stateMentCount*(e.height+this.spacing));return this.content.height=i,e.position=n,t==this.optionPrefab&&(e.x=-192.5),this.scrollView.scrollToOffset(cc.v2(0,this._stateMentCount*(e.height+this.spacing)+this.spacing),.5),e},initStateMent:function(t,e,i){var n=t.getComponent("stateMent");n.changeHeadSprite(e),n.playTextLabel(i)},initOptionBtn:function(t,e,i,n){t.getComponent("chooseBtn").btnInit(this.node,e,i,n)}}),cc._RF.pop()},{}],talkTrigger:[function(t,e,i){"use strict";cc._RF.push(e,"86fe1HSzW1JHpWqK2/jzEWs","talkTrigger"),cc.Class({extends:cc.Component,properties:{_talkFlag:!1,roleName:cc.String},onLoad:function(){this.node.on("touchstart",this.sendTrigger,this),this.nodeLabel=this.node.getChildByName("attention"),this.nodeLabel.active=!1},sendTrigger:function(){this._talkFlag&&(cc.director.emit("talkStart",this.roleName),this.nodeLabel.active=!1,this._talkFlag=!1)},onCollisionEnter:function(t,e){this.nodeLabel.active=!0,this._talkFlag=!0},onCollisionExit:function(t,e){this.nodeLabel.active=!1,this._talkFlag=!1,cc.director.emit("textBoxHide")}}),cc._RF.pop()},{}],trainMove:[function(t,e,i){"use strict";cc._RF.push(e,"3ee76w80dNG26a5V9naIUkT","trainMove"),cc.Class({extends:cc.Component,properties:{train1:cc.Node,train2:cc.Node,bg:cc.Node,moveSpeed:30,_count:1,_moveFlag:!0},onLoad:function(){this.train1.position=cc.v2(0,-6),this.train2.position=cc.v2(3642,-6)},update:function(t){this.trainMove(t)},trainMove:function(t){this._moveFlag&&(this.train1.x+=t*this.moveSpeed,this.train2.x+=t*this.moveSpeed,1==this._count%2?this.train1.x>this.bg.width/2&&(this.train2.x=-2675,this._count++):this.train2.x>this.bg.width/2&&(this.train1.x=-2675,this._count--))}}),cc._RF.pop()},{}]},{},["cameraMove","endScript","firstSceneInit","globalPlayer","listScrollView","moveCtl","labelFadeout","startBtn","startPlayerAnim","trainMove","talkSys","talkTrigger","chooseBtn","stateMent"]);